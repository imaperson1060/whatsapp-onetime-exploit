import pkg from "whatsapp-web.js";
import qrcode from "qrcode-terminal";

const { Client, LocalAuth, MessageMedia } = pkg;
const client = new Client({
    authStrategy: new LocalAuth(),
    puppeteer: {
        headless: true
    }
});

client.on("message", async msg => {
    if (msg.hasQuotedMsg && msg.body == "!view") {
        var quotedMsg = await msg.getQuotedMessage();
        if (!quotedMsg.hasMedia || !quotedMsg._data.isViewOnce) return msg.reply("The replied to message does not have a single view photo.");
        var onetime = await quotedMsg.downloadMedia();
        await msg.reply(new MessageMedia(onetime.mimetype, onetime.data, onetime.filename, onetime.filesize));
    }
});
client.on("qr", qr => qrcode.generate(qr, { small: true }));
client.on("ready", () => console.log("Client is ready!"));

client.initialize();